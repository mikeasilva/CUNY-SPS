---
title: "DATA 612 Week #1 Textbook Exercises"
author: "Mike Silva"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
---


```{r knitr_init, echo=FALSE, cache=FALSE, warning=FALSE, message=FALSE}
library(knitr)
library(rmdformats)
library(tidyverse)
library(kableExtra)
## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
```

## LMR 1.1

The dataset *teengamb* concers a study of teenage gambline in Britain.  Make a numerical and graphical summary of the data, commenting on any features that you find interesting.  Limit the output you present to a quantity that a busy reader would find sufficient to get a basic understanding of the data.

**Estimates show teens in Britain gamble between 0 and 150 pounds annually.  Males gamble more than females.  They gamble on average nearly 8 times as much.**

```{r}
# A paper describing the original study can be found at http://www.utstat.utoronto.ca/reid/sta2201s/2012/teengamb.pdf.  First I will read in the data.  I will recode the sex variable making it easier to interpret.  The income variable is per week and the gambling is per year.  I will adjust the income to put it on the same basis.

teengamb <- read.delim("data/teengamb.txt") %>%
  mutate(sex = as.factor(ifelse(sex == 0, "Male", "Female")),
         income = income * 52)

ggplot(teengamb, aes(x = sex, y = gamble, color=sex)) + 
  geom_boxplot() +
  ylab("Pounds") +
  xlab(element_blank()) +
  theme(legend.position = "none") +
  ggtitle("Estimated Annual Gambling by Sex")
```

```{r}
temp <- teengamb %>%
  group_by(sex) %>%
  summarise(mpg = list(enframe(quantile(gamble, probs=c(0.25, 0.5, 0.75))))) %>% 
  unnest() %>%
  spread(name, value)

teengamb %>%
  group_by(sex) %>%
  summarise(`Min.` = min(gamble),
            Mean = mean(gamble),
            `Max.` = max(gamble)) %>%
  merge(temp) %>%
  select(sex, `Min.`, `25%`, `50%`, Mean, `75%`, `Max.`) %>%
  kable() %>%
  kable_styling()
```

**Teens earned between 31 and 780 pounds annually.  Those who earned more were more likely to gammble more.**

```{r}
ggplot(teengamb, aes(x = income, y = gamble)) + 
  geom_point() + 
  geom_smooth(method = "lm") +
  xlab("Annual Income (Pounds)") +
  ylab("Annual Gambling (Pounds)") +
  ggtitle("Income vs. Gambling")
```

## LMR 1.3

The dataset *prostate* is from a study on 97 men with prostate conacer who were due to receive a radical prostatectomy.  Make a numerical and graphical summary of the data as in the first question.

```{r}
#lcavol log(cancer volume)
#lweight log(prostate weight)
#age age
#lbph log(benign prostatic hyperplasia amount)
#svi seminal vesicle invasion
#lcp log(capsular penetration)
#gleason Gleason score
#pgg45 percentage Gleason scores 4 or 5
#lpsa log(prostate specific antigen)

prostate <- read.delim("data/prostate.txt") 
pairs(prostate)
```

## LMR 1.4

The dataset *sat* comes from a study entitled "Getting What You Pay For: The Debate Overty Equity in Public School Expenditures."  Make a numerical and graphical summary of the data as in the first question.

## LMR 1.5

The dataset *divusa* contains data on divorces in the United States from 1920 to 1996.  Make a numerical and graphical summary of the data as in the first question.